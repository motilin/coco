(this.webpackJsonpcoco=this.webpackJsonpcoco||[]).push([[0],{369:function(e,t,n){},371:function(e,t,n){},377:function(e,t){},378:function(e,t){},386:function(e,t){},402:function(e,t,n){"use strict";n.r(t);var c=n(33),r=n.n(c),a=n(304),i=n.n(a),s=(n(369),n(8)),u=n.n(s),o=n(13),b=n(5),l=(n(371),n(35));function j(e){var t=e.img,n=e.setIsReady,r=Object(c.useState)(null),a=Object(b.a)(r,2),i=a[0],s=a[1],u=Object(c.useState)(null),o=Object(b.a)(u,2),j=o[0],d=o[1],f=Object(c.useRef)(null);return Object(l.jsxs)("div",{className:"image",children:[Object(l.jsx)("input",{className:"imageInput",type:"file",name:"file",onChange:function(e){f.current=!1,s(null),d(null),n(!1),function(e){var n=e.target.files[0];if(n&&"image"===n.type.substr(0,5)){var c=new FileReader;c.onload=function(e){t.current.src=c.result,t.current.alt=n.name},c.readAsDataURL(n)}}(e)}}),Object(l.jsx)("img",{ref:t,alt:"",onLoad:function(e){var c=.9*window.innerWidth,r=.9*window.innerHeight,a=t.current.width,i=t.current.height/a;i>r/c?(d(r),s(r/i)):(s(c),d(c*i)),f.current=!0,n(!0)},style:{width:i,height:j},crossOrigin:"anonymous"})]})}function d(e){var t=e.video,n=e.setIsReady,r=Object(c.useRef)(null);function a(){return a=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){e.next=5;break}return e.next=3,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}});case 3:r.current=e.sent,"srcObject"in t?t.srcObject=r.current:t.src=window.URL.createObjectURL(r.current);case 5:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}return Object(c.useEffect)((function(){return function(e){a.apply(this,arguments)}(t.current),function(){return r.current.getTracks()[0].stop()}}),[]),Object(l.jsx)("video",{ref:t,onLoadedData:function(){n(!0)},autoPlay:!0})}var f=n(214),O=f.b(f.a).domain([.5,1]);function h(e){var t=e.prediction,n=e.input,r=Object(c.useState)(),a=Object(b.a)(r,2),i=a[0],s=a[1],u=Object(c.useState)(),o=Object(b.a)(u,2),j=o[0],d=o[1],f=Object(c.useState)(),h=Object(b.a)(f,2),x=h[0],g=h[1],v=Object(c.useState)(),p=Object(b.a)(v,2),m=p[0],w=p[1];Object(c.useEffect)((function(){if(n.current){var e=n.current.getBoundingClientRect();s(e.top),d(e.left),g(e.width),w(e.height)}}));var y=t.map((function(e,t){return Object(l.jsxs)("g",{children:[Object(l.jsx)("rect",{className:"bbox",x:e.bbox[0],y:e.bbox[1],width:e.bbox[2],height:e.bbox[3],stroke:O(e.score),opacity:e.score-0},t),Object(l.jsx)("rect",{className:"labelBox",x:e.bbox[0],y:e.bbox[1],width:10*e.class.length,height:20,fill:O(e.score),opacity:e.score-0}),Object(l.jsx)("text",{className:"label",x:e.bbox[0]+1,y:e.bbox[1]+20-6,children:e.class})]})}));return console.log(t),t?Object(l.jsx)("svg",{style:{top:i,left:j,width:x,height:m},children:y}):null}n.p;n(400),n(399);var x=n(389),g=Object(c.createContext)();function v(e){var t=e.children,n=Object(c.useState)(null),r=Object(b.a)(n,2),a=r[0],i=r[1],s=Object(c.useState)(null),j=Object(b.a)(s,2),d=j[0],f=(j[1],function(){var e=Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.load();case 2:t=e.sent,i(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object(c.useEffect)((function(){f()}),[]),a?Object(l.jsx)(g.Provider,{value:{model:a,cocoLabels:d},children:t}):Object(l.jsx)("h2",{className:"loadingModel",children:"Loading model ..."})}var p=!1;function m(){document.title="coco";var e=Object(c.useRef)(),t=Object(c.useRef)(null),n=Object(c.useRef)(null),r=Object(c.useRef)(null),a=Object(c.useState)(!1),i=Object(b.a)(a,2),s=i[0],f=i[1],O=Object(c.useState)(null),x=Object(b.a)(O,2),v=x[0],m=x[1],w=Object(c.useState)([]),y=Object(b.a)(w,2),R=y[0],S=y[1],k=Object(c.useContext)(g).model,C=Object(c.useCallback)(Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.detect(r.current);case 2:t=e.sent,S(t),p&&window.requestAnimationFrame((function(){return C()}));case 5:case"end":return e.stop()}}),e)}))),[]),L=Object(c.useCallback)((function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{type:"checkbox",name:"toggle",ref:e,checked:s,onChange:function(){p=!p,m(!1),f(!s)}}),Object(l.jsx)("label",{htmlFor:e,children:"video"})]})}),[s]);return Object(c.useEffect)((function(){v&&(r.current=s?n.current:t.current,C())}),[s,v]),Object(l.jsxs)("div",{children:[Object(l.jsx)(L,{}),s?Object(l.jsx)(d,{video:n,setIsReady:m}):Object(l.jsx)(j,{img:t,setIsReady:m}),Object(l.jsx)(h,{prediction:R,input:r})]})}var w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,403)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(v,{children:Object(l.jsx)(m,{})})}),document.getElementById("root")),w()}},[[402,1,2]]]);
//# sourceMappingURL=main.7d2a704a.chunk.js.map