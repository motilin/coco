(this.webpackJsonpcoco=this.webpackJsonpcoco||[]).push([[0],{262:function(e,t,n){},263:function(e,t,n){},270:function(e,t){},271:function(e,t){},279:function(e,t){},282:function(e,t){},283:function(e,t){},284:function(e,t){},285:function(e,t,n){"use strict";n.r(t);var c=n(38),r=n.n(c),i=n(235),o=n.n(i),u=(n(262),n(4)),a=(n(263),n(43));function s(e){var t=e.img,n=e.setIsReady,r=Object(c.useState)(null),i=Object(u.a)(r,2),o=i[0],s=i[1],l=Object(c.useState)(null),f=Object(u.a)(l,2),b=f[0],d=f[1],j=Object(c.useRef)(null);return Object(a.jsxs)("div",{className:"image",children:[Object(a.jsx)("input",{className:"imageInput",type:"file",name:"file",onChange:function(e){j.current=!1,n(!1),function(e){var n=e.target.files[0];if(n&&"image"===n.type.substr(0,5)){var c=new FileReader;c.onload=function(e){t.current.src=c.result},c.readAsDataURL(n)}}(e)}}),Object(a.jsx)("img",{ref:t,alt:"upload an image",onLoad:function(e){var c=.9*window.innerWidth,r=.9*window.innerHeight,i=t.current.width,o=t.current.height/i;o>r/c?(d(r),s(r/o)):(s(c),d(c*o)),j.current=!0,n(!0)},style:{width:o,height:b}})]})}var l=n(5),f=n.n(l),b=n(11);function d(e){var t=e.video,n=e.setIsReady,r=Object(c.useRef)(null);function i(){return i=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){e.next=5;break}return e.next=3,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}});case 3:r.current=e.sent,"srcObject"in t?t.srcObject=r.current:t.src=window.URL.createObjectURL(r.current);case 5:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}return Object(c.useEffect)((function(){return function(e){i.apply(this,arguments)}(t.current),function(){return r.current.getTracks()[0].stop()}}),[]),Object(a.jsx)("video",{ref:t,onLoadStart:function(){n(!0)},autoPlay:!0})}var j=n(104),O=n.p+"static/media/coco_labels.f6197292.txt",h=Object(c.createContext)();function p(e){var t=e.children,n=Object(c.useState)(null),r=Object(u.a)(n,2),i=r[0],o=r[1],s=Object(c.useState)(null),l=Object(u.a)(s,2),d=l[0],p=l[1],v=function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O);case 2:return t=e.sent,e.next=5,t.text();case 5:n=e.sent,c=n.split(/\r?\n/),r=new Array(90),c.map((function(e){var t=e.split(/(?<=^\S+)\s/),n=parseInt(t[0]),c=t[1].trim();r[n]=c})),p(r);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){v(),j.c().then((function(){j.d((function(){j.b("https://tfhub.dev/tensorflow/tfjs-model/ssd_mobilenet_v2/1/default/1",{fromTFHub:!0}).then((function(e){return o(e)}))}))}))}),[]),i&&d?Object(a.jsx)(h.Provider,{value:{model:i,cocoLabels:d},children:t}):Object(a.jsx)("h2",{className:"loadingModel",children:"Loading model ..."})}var v=Object(c.createContext)();function g(e){var t=e.children,n=Object(c.useState)(),r=Object(u.a)(n,2),i=r[0],o=(r[1],Object(c.useState)()),s=Object(u.a)(o,2),l=s[0],f=(s[1],Object(c.useState)()),b=Object(u.a)(f,2),d=b[0],O=(b[1],Object(c.useRef)(null)),p=Object(c.useRef)(!1),g=Object(c.useContext)(h),m=(g.model,g.cocoLabels,function e(){j.c().then((function(){j.d((function(){j.a.fromPixels(O.current)}))})),console.log("prediction"),p.current&&window.requestAnimationFrame((function(){return e()}))});return Object(a.jsx)(v.Provider,{value:{labels:i,boxes:l,probabilities:d,predictImage:function(e){p.current=!1,O.current=e.current,m()},predictVideo:function(e){p.current=!0,O.current=e.current,m()},stopVideo:function(){p.current=!1}},children:t})}function m(){document.title="coco";var e=Object(c.useRef)(),t=Object(c.useRef)(null),n=Object(c.useRef)(null),r=Object(c.useState)(!1),i=Object(u.a)(r,2),o=i[0],l=i[1],f=Object(c.useState)(!1),b=Object(u.a)(f,2),j=b[0],O=b[1],h=Object(c.useContext)(v),p=h.labels,g=h.boxes,m=h.probabilities,x=h.predictImage,w=h.predictVideo,R=h.stopVideo,y=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{type:"checkbox",name:"toggle",ref:e,checked:o,onChange:function(){o&&R(),O(!1),l(!o)}}),Object(a.jsx)("label",{htmlFor:e,children:"video"})]})};return console.log(p),console.log(g),console.log(m),Object(c.useEffect)((function(){j&&(o?w(n):x(t))}),[o,j]),Object(a.jsxs)("div",{children:[Object(a.jsx)(y,{}),o?Object(a.jsx)(d,{video:n,setIsReady:O}):Object(a.jsx)(s,{img:t,setIsReady:O})]})}var x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,286)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),i(e),o(e)}))};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(p,{children:Object(a.jsx)(g,{children:Object(a.jsx)(m,{})})})}),document.getElementById("root")),x()}},[[285,1,2]]]);
//# sourceMappingURL=main.3326023f.chunk.js.map